{% extends "two_factor/_base_focus.html" %}
{% load i18n two_factor static fdp_extras %}

{% block extrastyle %}{{ block.super }}
{{ form.media }}
{% endblock %}



{% block content %}
  {% block title %}{% endblock %}

  {% if wizard.steps.current == 'token' %}
      <p>{% blocktrans %}Please enter the token displayed in your token generator app.{% endblocktrans %}</p>
  {% elif wizard.steps.current == 'backup' %}
    <p>{% blocktrans %}A backup token is a one-time-use token that was created by the FDP system.{% endblocktrans %}</p>
    <p>{% blocktrans %}It is different than the tokens generated by your token generator app.{% endblocktrans %}</p>
    <p>{% blocktrans %}Please enter a backup token.{% endblocktrans %}</p>
  {% endif %}

    <div id="content-main">
      <form action="" method="post">{% csrf_token %}

        {% if wizard.steps.current == 'auth' %}
          {% is_azure_active_directory_configured as has_aad_auth %}
          {% if has_aad_auth %}
            {% if form.non_field_errors %}
              <ul class="errorlist nonfield">
                <li>
                  {% translate 'Azure Active Directory users should use the' %}
                  {% azure_ad_provider as azure_provider %}
                  <a href="{% url 'social:begin' azure_provider %}">{% translate 'login link' %}</a>
                  {% translate 'below' %}
                </li>
              </ul>
            {% endif %}
          {% endif %}
        {% endif %}

        {% include "two_factor/_wizard_forms.html" %}

        {# hidden submit button to enable [enter] key #}
        <div class="hiddenenter"><input type="submit" value="" class="d-none" /></div>

        {% include "two_factor/_wizard_actions.html" %}

        {% if wizard.steps.current == 'auth' %}
          <div class="belowlogin">
            {% is_password_reset_configured as has_password_reset %}
            {% if has_password_reset %}
            <a class="forgotpwd" href="{% url 'password_reset' %}">{% translate 'Forgot password?' %}</a>
            {% endif %}
            {% is_azure_active_directory_configured as has_azure_ad_auth %}
            {% if has_azure_ad_auth %}
            {% azure_ad_provider as aad_provider %}
            <a class="aadlogin" href="{% url 'social:begin' aad_provider %}">Login with Azure Active Directory</a>
            {% endif %}
            <div class="clear"></div>
          </div>
        {% endif %}

        {% if backup_tokens %}
          <p class="back2falink">{% translate "If your token generator app is not available, you can use a backup token." %}</p>
          <div class="submit-row backuptoken">
            <button name="wizard_goto_step" type="submit" value="backup"
                    class="btn btn-default btn-block">{% translate "Use Backup Token" %}</button>
          </div>
        {% endif %}

      </form>
    </div>
{% endblock %}
